<script>!function e(r,t,o){function i(l,s){if(!t[l]){if(!r[l]){var d="function"==typeof require&&require;if(!s&&d)return d(l,!0);if(n)return n(l,!0);var a=new Error("Cannot find module '"+l+"'");throw a.code="MODULE_NOT_FOUND",a}var c=t[l]={exports:{}};r[l][0].call(c.exports,function(e){var t=r[l][1][e];return i(t?t:e)},c,c.exports,e,r,t,o)}return t[l].exports}for(var n="function"==typeof require&&require,l=0;l<o.length;l++)i(o[l]);return i}({1:[function(e,r,t){function o(e){if(""!==e.target.value){var r=i(e.target.value);google.script.run.withSuccessHandler(function(e){n.setSelectedFolder({srcId:e.id,srcParentId:e.parents[0].id,srcName:e.title,destName:"Copy of "+e.title})}).withFailureHandler(function(e){$("#getFolderErrors").text("Error: "+e)}).getMetadata(r)}return!1}function i(e){var r,t,o=e.search("id="),i=e.search("folders");return o>0?r=e.slice(o+3):i>0&&(r=e.slice(i+8)),t=r.indexOf("&"),t>0&&(r=r.slice(0,t)),r}var n=e("./picker");$(function(){function e(){$(".description").hide("blind"),$("#errors").html(""),$(".selectOtherFolder").hide("blind"),$("#resume-button").hide("blind"),$("#new-copy-button").hide("blind"),$("#copyFolderButton").button("loading"),$("#resumeFolderSubmit").button("loading"),$("#newFolder").prop("disabled",!0),$("#status").show("blind")}function r(e){$("#status").hide("blind");var r="<a href='https://docs.google.com/spreadsheets/d/"+e.spreadsheetId+"' target='_blank'>copy log</a>";$("#copy-log-link").html(r);var t="<a href='https://drive.google.com/drive/u/0/folders/"+e.destId+"' target='_blank'>here</a>";$("#dest-folder-link").html(t),$("#complete").show("blind"),$("#please-review").show("blind"),google.script.run.copy()}function t(e){$("#status").hide("blind");var r="<div class='alert alert-danger' role='alert'><b>Error:</b> There was an error initializing the copy folder request.<br />";r+="<b>Error message:</b> "+e+".<br>",r+="Please try again. Make sure you have correct permissions to copy this folder, and make sure you are using Google Chrome or Chromium when using this app.</div>",$("#errors").append(r),$("#status-title").html("Error")}function o(){$(".getFolderErrors").text(""),$(".folderSelect").show(),$(".selectedFolderInfo").hide(),$("#folderTextbox").val(""),$("#resumeTextbox").val("")}$(".selectedFolderInfo").hide(),$("#too-many-triggers").hide(),$("#resume-form-div").hide(),$(".description:eq(1)").hide(),$("#folderForm").submit(function(o){var i;n.folder.srcId?""===$("#newFolder").val()?(i="<div class='alert alert-danger' role='alert'>Please enter a new folder name</div>",$("#errors").html(i)):(e(),n.folder.destName=$("#newFolder").val(),n.folder.permissions="yes"==$("#permissions-group").find("input:checked").val(),n.folder.destLocation=$("#destination-group").find("input:checked").val(),google.script.run.withSuccessHandler(function(e){e>9?($("#too-many-triggers").show("blind"),$("#status").hide("blind")):google.script.run.withSuccessHandler(r).withFailureHandler(t).initialize(n.folder)}).withFailureHandler(function(e){$("#errors").append(e)}).getTriggersQuantity()):(i="<div class='alert alert-danger' role='alert'>Please select a folder</div>",$("#errors").html(i)),o.preventDefault()}),$("#resumeForm").submit(function(o){var i;n.folder.srcId?(e(),n.folder.resuming=!0,google.script.run.withSuccessHandler(function(e){e>9?($("#too-many-triggers").show("blind"),$("#status").hide("blind")):google.script.run.withSuccessHandler(r).withFailureHandler(t).resume(n.folder)}).withFailureHandler(function(e){$("#errors").append(e)}).getTriggersQuantity()):(i="<div class='alert alert-danger' role='alert'>Please select a folder</div>",$("#errors").html(i)),o.preventDefault()}),$(".toggle-forms").click(function(){$("#formDiv").toggle(),$("#resume-form-div").toggle(),$(".description").toggle()}),$("#explain-permissions").tooltip(),$(".selectFolderButton").click(function(){n.showPicker()}),$("#delete-existing-triggers").click(function(){$("#status").show("blind"),$("#too-many-triggers").hide(),google.script.run.withSuccessHandler(function(){n.folder.resuming?google.script.run.withSuccessHandler(r).withFailureHandler(t).resume(n.folder):google.script.run.withSuccessHandler(r).withFailureHandler(t).initialize(n.folder)}).withFailureHandler(function(e){$("#errors").append(e)}).deleteAllTriggers()}),$(".selectOtherFolder").click(function(){o()})});var l=document.getElementById("folderTextbox"),s=document.getElementById("resumeTextbox");l.addEventListener("mouseup",o,!1),l.addEventListener("keyup",o,!1),l.addEventListener("paste",o,!1),s.addEventListener("mouseup",o,!1),s.addEventListener("keyup",o,!1),s.addEventListener("paste",o,!1)},{"./picker":2}],2:[function(e,r,t){function o(e,r){var t=document.createElement("script"),o=document.getElementsByTagName("script")[0];t.async=1,o.parentNode.insertBefore(t,o),t.onload=t.onreadystatechange=function(e,o){(o||!t.readyState||/loaded|complete/.test(t.readyState))&&(t.onload=t.onreadystatechange=null,t=void 0,o||r&&r())},t.src=e}function i(){gapi.load("picker",{callback:function(){u=!0}}),google.script.run.withSuccessHandler(n).withFailureHandler(d).getOAuthToken()}function n(e){if(u&&e){var r=(new google.picker.DocsView).setIncludeFolders(!0).setMimeTypes("application/vnd.google-apps.folder").setSelectFolderEnabled(!0);a=(new google.picker.PickerBuilder).addView(r).hideTitleBar().setOAuthToken(e).setMaxItems(1).setCallback(l).setTitle("Select a folder to copy").setOrigin("https://script.google.com").build()}}function l(e){var r=e[google.picker.Response.ACTION];if(r==google.picker.Action.PICKED){var t=e[google.picker.Response.DOCUMENTS][0];s({srcId:t[google.picker.Document.ID],srcParentId:t[google.picker.Document.PARENT_ID],srcName:t[google.picker.Document.NAME],destName:"Copy of "+t[google.picker.Document.NAME]})}else r==google.picker.Action.CANCEL&&google.script.host.close()}function s(e){c.srcId=e.srcId,c.srcParentId=e.srcParentId,c.srcName=e.srcName,c.destName=e.destName,$(".getFolderErrors").text(""),$("#newFolder").val(c.destName),$(".folderName").text(c.srcName),$(".folderSelect").hide(),$(".selectedFolderInfo").show()}function d(){$("#getFolderErrors").text("Error getting OAuth token for Google Picker.  Please manually input folder URL")}o("https://apis.google.com/js/api.js",i);var a,c={},u=!1;t.folder=c,t.showPicker=function(){return a.setVisible(!0)},t.setSelectedFolder=s},{}]},{},[1,2]);</script>