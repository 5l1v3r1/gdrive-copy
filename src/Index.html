<!-- Use a templated HTML printing scriptlet to import common stylesheet. -->
<?!= HtmlService.createHtmlOutputFromFile('css').getContent(); ?>

<html>
  <head>

    <!--Include Font Awesome CDN for icons-->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css">

    <!--Webfont loader for Google Apps Scripts-->
    <script src="https://ajax.googleapis.com/ajax/libs/webfont/1.5.18/webfont.js"></script>
    <script>
      WebFont.load({
        google: {
          families: ['Lato']
        }
      });
    </script>
  
  </head>
  <body>
  
  
  <!--.container holds all content except .footer-->
  <div class="container" id="container">
  
    <h1>
       Copy a google drive folder and all its contents
    </h1>

    <div id="description">
       Just input the folder sharing url and a new folder name, and it will copy to your home folder in Google drive.<br />
       This app will recursively copy the folder structure, and is designed to work well for deep folder structures.<br />
       To select the folder to transfer:
       <ol>
         <li>Find the folder in your Google Drive</li>
         <li>Right click your folder</li>
         <li>Select ''Get link'' and press CTRL-C to copy</li>
       </ol>
       OR
       <ol>
         <li>Open the folder in Google Drive</li>
         <li>Copy the URL from the browser address bar</li>
       </ol>
       <br />
    </div>
    
    
    
    
    <!--Form-->
    <div id="formDiv">
      <form id="thisForm" name="thisForm"  class="form-horizontal">
      
        <!--Select Folder-->
        <div class="form-group">
          <label for="folderId" class="col-sm-3 control-label">Folder to copy</label>
          <div class="col-sm-9">
            <button type="button" id="selectFolderButton" class="btn btn-primary" autocomplete="off">Select Folder</button>
            <div id="folderName"></div>
          </div>
        </div>
        
        <!--Insert folder name-->
        <div class="form-group">
          <label for="newFolder" class="col-sm-3 control-label">New folder name</label>
          <div class="col-sm-9">
            <input type="textbox" id="newFolder" name="newFolder" class="form-control" placeholder="New folder name">
          </div>
        </div>
        
        <!--Copy permissions?-->
        <div class="form-group">
          <div class="col-sm-offset-3 col-sm-9">
            <label class="checkbox-title" for="permissions">Copy sharing permissions &nbsp;<input type="checkbox" id="permissions" name="permissions" /></label>
            <i id="explain-permissions" class="fa fa-question-circle" data-toggle="modal" data-target="#dialog-message"></i>  
          </div>
        </div>
        
        <!--Copy to-->
        <div class="form-group">
          <label class="col-sm-3 control-label">Copy folder to</label>
          <div class="col-sm-9">
            <div class="radio">
              <label>
                <input type="radio" name="copyLocationOptions" id="sameDir" value="same" checked>
                Same as source folder
              </label>
            </div>
            <div class="radio">
              <label>
                <input type="radio" name="copyLocationOptions" id="rootDir" value="root">
                Root directory (i.e. at the top of "My Drive")
              </label>
            </div>
            <!--This will require another picker; let's get the first one working first-->
            <!--<div class="radio disabled">
              <label>
                <input type="radio" name="optionsRadios" id="optionsRadios3" value="option3">
                Select another
              </label>
            </div>-->
          </div>
        </div>
        
        
        <div class="form-group">
          <div class="col-sm-offset-3 col-sm-9">
            <button type="submit" id="copyFolderButton" data-loading-text="Copying..." class="btn btn-primary" autocomplete="off">Copy folder</button>
          </div>
        </div>

      </form>

    </div>
    
    
    
      
    <!-- Modal -->
    <div class="modal fade" id="dialog-message" tabindex="-1" role="dialog" aria-labelledby="Copy Sharing Permissions">
      <div class="modal-dialog" role="document">
        <div class="modal-content">
          
          <!--Modal title-->
          <div class="modal-header">
            <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
            <h4 class="modal-title" id="dialog-title">Copy Sharing Permissions</h4>
          </div>
          
          <!--Modal text-->
          <div class="modal-body">
            <p>
              Selecting this box will create the new folder/sub-folders/documents with the same sharing permissions (e.g. "Edit", "View") as the original documents.  
            </p>
    
            Notes:
            <ul>
              <li>Anyone that was an owner of the original document/folder will simply be given "Edit" rights.  If you need to transfer ownership of the folder, please see my <a href="https://chrome.google.com/webstore/detail/transfer-ownership/ndbdlpeegehlbhgnpifancfbnnehoofa" target="_blank">Transfer Ownership</a> tool.</li>
              <li>This will send <b><i>several</i></b> emails to each owner, editor and viewer.  Please <b><i>do not</i></b> select this option if the emails will annoy your collaborators.</li>
              <li>It will take slightly longer to copy the folder with this option enabled</li>
            </ul>
          </div>
          
          <!--Modal buttons-->
          <div class="modal-footer">
            <button type="button" class="btn btn-primary" data-dismiss="modal">Ok</button>
          </div>
          
        </div>
      </div>
    </div>
      
     
    
    
    <!--These divs display when complete-->
    <div id="complete" class='alert alert-success' role='alert'>
        Successfully copied folder to your <a href="http://drive.google.com">Google Drive</a>.
    </div>
    
    <div id="please-review" class="panel panel-default">
      <div class="panel-heading">Have an extra 30 seconds?</div>
      <div class="panel-body">
        Please take a moment to <a href="https://chrome.google.com/webstore/detail/copy-folder/kfbicpdhiofpicipfggljdhjokjblnhl/reviews" target="_blank">rate and review this app</a> in the Chrome Web Store.
      </div>
    </div>
    
    <!--These divs get filled programatically at runtime-->
    <div id="errors"></div>
    <div id="status">
      <div class="panel panel-default">
        <div class="panel-heading">
          <div class="panel-title">
            <h4 id="status-title">Copying folder structure <i class="fa fa-spinner fa-spin"></i></h4>
          </div>
        </div>
        <div class="panel-body">
          <table id="status-table" class='table table-striped'>
            <tr>
              <th>Folder path</th>
              <th>Status</th>
            </tr>
          </table>
        </div>
      </div>
    </div>
       
      
  </div><!--end .container-->
  
  
  
  
  <!--Footer-->
  <footer class="footer">
    <div class="container-fluid">
      <div class="row">
        
        <!--Promotion for Transfer Ownership-->
        <div class="col-sm-offset-2 col-sm-2">
          <b>Transfer folder ownership</b><br /> 
          Check out <a href="https://chrome.google.com/webstore/detail/transfer-ownership/ndbdlpeegehlbhgnpifancfbnnehoofa" target="_blank">my other project</a>
        </div>
        
        <!--Github-->
        <div class="col-sm-2">
          <b>Source code</b><br />
          <a href="https://github.com/ericyd/gdrive-copy" target="_blank">Github</a>
        </div>
        
        <!--ericyd.com-->
        <div class="col-sm-2">
          <b>Developer's website</b><br />
          <a href="http://ericyd.com" target="_blank">ericyd.com</a>
        </div>
        
        <!--email-->
        <div class="col-sm-2">
          <b>Comments? Questions? Concerns?</b><br />
          eric@ericyd.com
        </div>
      </div>
    </div>
  </footer>
  
  </body>
</html>

<!-- Use a templated HTML printing scriptlet to import JavaScript. -->
<?!= HtmlService.createHtmlOutputFromFile('js').getContent(); ?>
