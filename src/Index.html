<!-- Use a templated HTML printing scriptlet to import common stylesheet. -->
<?!= HtmlService.createHtmlOutputFromFile('bootstrap').getContent(); ?>
<?!= HtmlService.createHtmlOutputFromFile('css').getContent(); ?>



<html>
  <head>

    <!--Include Font Awesome CDN for icons-->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css">

    <!--Webfont loader for Google Apps Scripts-->
    <script src="https://ajax.googleapis.com/ajax/libs/webfont/1.5.18/webfont.js"></script>
    <script>
      WebFont.load({
        google: {
          families: ['Lato']
        }
      });
    </script>
  
  </head>
  <body>
  
  
  <!--.container holds all content except .footer-->
  <div class="container" id="container">
  
    <h1>
       Copy a google drive folder and all its contents
    </h1>

    <div id="description" class="description">
       Just input the folder sharing url and a new folder name, and it will copy to your home folder in Google drive.<br />
       To get started, simply select your folder and choose a new name, then select Copy Folder!<br />
        If the folder copy get's stuck, simply use the "Resume prior folder copy" button, then select the copy of your folder.<br />
    </div>

    <div id="resume-description" class="description">
        Sometimes this app will get stuck (sorry!).  To resume a folder copy that is in-progress, but paused for whatever reason, simply
        select the <b><i>new, incomplete copy</i></b> of the folder and select "Resume copying".
    </div>


    
    <!--Form-->
    <div id="formDiv" class="form-div">
      <form id="folderForm" name="folderForm"  class="form-horizontal">
      
        <!--Select Folder-->
        <div class="form-group">
          <label for="selectFolderButton" class="col-lg-2 col-md-4 col-sm-4 control-label">Folder to copy</label>
          <div class="col-lg-10 col-md-8 col-sm-8">
            <!--Elements to select folder-->
            <div class="row folderSelect">
                <div class="col-lg-3 col-md-4 col-xs-12">
                    <button type="button" id="selectFolderButton" class="btn btn-primary btn-block selectFolderButton">Select Folder</button>
                </div>
                <span class="col-lg-1 col-md-1 col-xs-12 center">or</span>
                <div class="col-lg-8 col-md-7 col-xs-12">
                    <input type="text" id="folderTextbox" class="form-control" placeholder="Paste folder URL (Ctrl-V)">
                </div>
            </div> 
            
            <div class="getFolderErrors"></div>
            
            <!--Display when folder is selected-->
            <div id="selectedFolderInfo" class="selectedFolderInfo">
                <span class="folderName"></span> &nbsp;&nbsp;
                <button type="button" class="btn btn-default selectOtherFolder">Select other folder</button>
            </div>
          </div>
        </div>
        
        <!--Insert folder name-->
        <div class="form-group">
          <label for="newFolder" class="col-lg-2 col-md-4 col-sm-4 control-label">New folder name</label>
          <div class="col-lg-10 col-md-8 col-sm-8">
            <input type="textbox" id="newFolder" name="newFolder" class="form-control" placeholder="New folder name">
          </div>
        </div>
        
        <!--Copy permissions?-->
        <div class="form-group" id="permissions-group">
          <label class="col-lg-2 col-md-4 col-sm-4 control-label checkbox-title" for="permissions">
            <!--Question mark button-->
            <a role="button" href="#" id="explain-permissions" class="btn" data-toggle="tooltip" title="Select this box if you want the documents in the folder copy to be editable/viewable by the same people as the originals.  Owners of originals will become editors of the copies.  Copying takes much longer if 'Yes' is selected." data-trigger="focus" data-placement="top" data-container="body">
                <i class="fa fa-question-circle"></i>
            </a>
            Copy sharing permissions
          </label>
          
          <div class="col-lg-10 col-md-8 col-sm-8" id="permissions">
             <!--<input type="checkbox" id="permissions" name="permissions" />-->
             <div class="radio-inline">
              <label>
                <input type="radio" name="permissions" value="no" checked>
                No
              </label>
            </div>
            <div class="radio-inline">
              <label>
                <input type="radio" name="permissions" value="yes">
                Yes
              </label>
            </div>
          </div>
        </div>
        
        <!--Copy to-->
        <div class="form-group" id="destination-group">
          <label class="col-lg-2 col-md-4 col-sm-4 control-label">Copy folder to</label>
          <div class="col-lg-10 col-md-8 col-sm-8">
            <div class="radio">
              <label>
                <input type="radio" name="copyLocationOptions" id="sameDir" value="same" checked>
                Same as source folder
              </label>
            </div>
            <div class="radio">
              <label>
                <input type="radio" name="copyLocationOptions" id="rootDir" value="root">
                Root directory (i.e. at the top of "My Drive")
              </label>
            </div>
          </div>
        </div>
        
        <!--Submit-->
        <div class="form-group">
          <div class="col-lg-offset-2 col-md-offset-4 col-sm-offset-4 col-lg-10 col-md-8 col-sm-8">
            <button type="submit" id="copyFolderButton" data-loading-text="Copying..." class="btn btn-primary">Copy folder</button>
          </div>
        </div>

      </form>

        <button type="button" class="btn btn-warning toggle-forms" id="resume-button">Resume prior folder copy</button>
          <br><br>
        <button type="button" class="btn btn-danger stop">Stop all copy folder instances</button>
    </div>



      <div id="resume-form-div" class="form-div">
          <form id="resumeForm" name="resumeForm"  class="form-horizontal">

              <!--Select Folder-->
              <div class="form-group">
                  <label for="resumeFolderSelect" class="col-lg-2 col-md-4 col-sm-4 control-label">Folder to copy</label>
                  <div class="col-lg-10 col-md-8 col-sm-8">
                      <!--Elements to select folder-->
                      <div class="row folderSelect">
                          <!--Button to activate Google Picker-->
                          <div class="col-lg-3 col-md-4 col-xs-12">
                              <button type="button" id="resumeFolderSelect" class="btn btn-primary btn-block selectFolderButton">Select Folder</button>
                          </div>

                          <span class="col-lg-1 col-md-1 col-xs-12 center">or</span>

                          <!--Textbox for pasting folder URL-->
                          <div class="col-lg-8 col-md-7 col-xs-12">
                              <input type="text" id="resumeTextbox" class="form-control" placeholder="Paste folder URL (Ctrl-V)">
                          </div>
                      </div>

                      <div class="getFolderErrors"></div>

                      <!--Display when folder is selected-->
                      <div class="selectedFolderInfo">
                          <span class="folderName"></span> &nbsp;&nbsp;
                          <button type="button" class="btn btn-default selectOtherFolder">Select other folder</button>
                      </div>
                  </div>
              </div>

              <!--Submit-->
              <div class="form-group">
                  <div class="col-lg-offset-2 col-md-offset-4 col-sm-offset-4 col-lg-10 col-md-8 col-sm-8">
                      <button type="submit" id="resumeFolderSubmit" data-loading-text="Resuming..." class="btn btn-primary">Resume copying</button>
                  </div>
              </div>

          </form>

          <button type="button" class="btn btn-warning toggle-forms" id="new-copy-button">Start new folder copy</button>
          <br><br>
          <button type="button" class="btn btn-danger stop">Stop all copy folder instances</button>
      </div>


    <div id='confirm-stop-message'>
      <h2>Are you sure you want to stop the instances of copy folder that you have running?</h2>
      <button type="button" class="btn btn-danger" id="stop-confirm">Yes, I want to stop all my current instances of Copy Folder</button><br><br>
      <button type="button" class="btn btn-success" id="show-new-copy">No thanks, take my back to the main form</button>
    </div>

    
    
    <!--These divs display when complete-->
    <div id="complete" class='alert alert-success' role='alert'>
        <b>Copying has started in background</b>
        <ul class="fa-ul">
            <li><i class="fa-li fa fa-cog"></i>Copying folder "<span class="folderName"></span>".  You may close this window and the copying will continue in the background.</li>
            <li><i class="fa-li fa fa-cog"></i>Please check the <span id="copy-log-link"></span> for progress updates. This log is located inside the newly created folder.</li>
            <li><i class="fa-li fa fa-cog"></i>The new folder copy can be found <span id="dest-folder-link"></span>.</li>
            <li><i class="fa-li fa fa-cog"></i>Please do not begin copying another folder until this copy is complete (developer is working to allow multiple copies at once)</li>
            <li><i class="fa-li fa fa-cog"></i>If the folder does not copy correctly, please email the author at eric@ericyd.com</li>
        </ul> 
    </div>
    
    <div id="please-review" class="panel panel-default">
      <div class="panel-heading">Have an extra 30 seconds?</div>
      <div class="panel-body">
        Please take a moment to <a href="https://chrome.google.com/webstore/detail/copy-folder/kfbicpdhiofpicipfggljdhjokjblnhl/reviews" target="_blank">rate and review this app</a> in the Chrome Web Store.
      </div>
    </div>

    <!--These divs get filled programatically at runtime-->
    <div id="errors"></div>
    <div id="too-many-triggers" class="alert alert-danger">
      There are too many existing Copy Folder instances running.
      Please wait until the other instances complete to begin a new folder copy.<br><br>
      If there are no other folders currently being copied, you can force this operation to continue.
      Note: This will stop any other folder copies that are active on your account.
      <button id="delete-existing-triggers" class="btn btn-danger">Force continue</button>
    </div>
    <div id="status">      
        <h4 id="status-title">Initializing copy request (this should just take a few moments) <i class="fa fa-spinner fa-spin"></i></h4>
    </div>
        
      
  </div><!--end .container-->
  
  
  
  
  <!--Footer-->
  <footer class="footer">
    <div class="container-fluid">
      <div class="row">
        
        <!--Github-->
        <div class="col-sm-offset-2 col-sm-2">
          <b>Source code</b><br />
          <a href="https://github.com/ericyd/gdrive-copy" target="_blank">Github</a>
        </div>
        
        <!--Promotion for Transfer Ownership-->
        <div class="col-sm-2">
          <b>Transfer folder ownership</b><br /> 
          Check out <a href="https://chrome.google.com/webstore/detail/transfer-ownership/ndbdlpeegehlbhgnpifancfbnnehoofa" target="_blank">my other project</a>
        </div>
        
        <!--ericyd.com-->
        <div class="col-sm-2">
          <b>Developer's website</b><br />
          <a href="http://ericyd.com" target="_blank">ericyd.com</a>
        </div>
        
        <!--email-->
        <div class="col-sm-2">
          <b>Comments? Questions? Concerns?</b><br />
          eric@ericyd.com
        </div>
      </div>
    </div>
  </footer>
  
  </body>
</html>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.2.3/jquery.min.js"></script>
<script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.11.4/jquery-ui.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js" integrity="sha384-0mSbJDEHialfmuBBQP6A4Qrprq5OVfW37PRR3j5ELqxss1yVqOtnepnHVP9aJ7xS" crossorigin="anonymous"></script>

<!-- Use a templated HTML printing scriptlet to import JavaScript. -->
<?!= HtmlService.createHtmlOutputFromFile('js').getContent(); ?>
